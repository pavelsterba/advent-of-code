<?php

declare(strict_types=1);

require $_composer_autoload_path ?? __DIR__ . '/../vendor/autoload.php';

use AdventOfCode\Command\AboutCommand;
use AdventOfCode\Command\DotEnvCommand;
use AdventOfCode\Command\InputCommand;
use AdventOfCode\Command\RunCommand;
use Symfony\Component\Console\Application;
use Symfony\Component\Dotenv\Dotenv;

$envFile = getcwd() . DIRECTORY_SEPARATOR . '.env';

if (is_readable($envFile)) {
    $dotenv = new Dotenv();
    $dotenv->load($envFile);

    $application = new Application();

    $about = new AboutCommand();

    $application->add(new InputCommand());
    $application->add(new DotEnvCommand());
    $application->add(new RunCommand());
    $application->add($about);

    $application->setDefaultCommand($about->getName());

    $application->run();
} else {
    echo ".env file not found in " . $envFile . "\n";
    echo "Create it using \"php vendor" . DIRECTORY_SEPARATOR . "bin" . DIRECTORY_SEPARATOR . "aot dotenv\".\n";
    exit(1);
}
